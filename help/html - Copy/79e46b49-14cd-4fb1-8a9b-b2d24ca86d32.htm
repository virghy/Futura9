<html DIR="LTR" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
  <head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" />
    <META NAME="save" CONTENT="history" />
    <title>How to: Create Persistent Relationships Between Tables</title>
    
    <link rel="stylesheet" type="text/css" href="../local/Classic.css">
      
    </link>
    
    <script src="../local/EventUtilities.js">
      
    </script>
    <script src="../local/SplitScreen.js">
      
    </script>
    <script src="../local/Dropdown.js">
      
    </script>
    <script src="../local/script.js">
      
    </script>
  </head>
  <body>
    <input type="hidden" id="userDataCache" class="userDataStyle">
    </input>
    <input type="hidden" id="hiddenScrollOffset">
    </input>
    <img id="dropDownImage" style="display:none; height:0; width:0;" src="../local/drpdown.gif">
      
    </img>
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../local/drpdown_orange.gif">
      
    </img>
    <img id="copyImage" style="display:none; height:0; width:0;" src="../local/copycode.gif">
      
    </img>
    <img id="copyHoverImage" style="display:none; height:0; width:0;" src="../local/copycodeHighlight.gif">
      
    </img>
    <div id="header">
      <table width="100%" id="topTable">
        <tr id="headerTableRow1">
          <td align="left">
            <span id="runningHeaderText">
              Visual FoxPro 9.0 SP2
            </span>
          </td>
        </tr>
        <tr id="headerTableRow2">
          <td align="left">
            <span id="nsrTitle">How to: Create Persistent Relationships Between Tables</span>
          </td>
        </tr>
        <tr id="headerTableRow3">
          <td>
            <a href="#seeAlsoNoToggle" onclick="OpenSection(seeAlsoNoToggle)">See Also</a> 
									</td>
        </tr>
      </table>
      <table width="100%" id="bottomTable" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <span id="languageFilterToolTip" style="cursor:default;" onmouseover="languageFilterImage.src=dropDownHoverImage.src;" onmouseout="languageFilterImage.src=dropDownImage.src;" tabindex="0">
              <img id="languageFilterImage" src="../local/drpdown.gif">
                
              </img>
              <label id="showAllLabel" for="languageFilterImage" style="display: none;">
                Language Filter: 
                    All
                  
              </label>
              <label id="multipleLabel" for="languageFilterImage" style="display: none;">
                Language Filter: 
                    Multiple
                  
              </label>
              <label id="vbLabel" for="languageFilterImage" style="display: none;">
                Language Filter: 
                    Visual Basic
                  
              </label>
              <label id="csLabel" for="languageFilterImage" style="display: none;">
                Language Filter: 
                    C#
                  
              </label>
              <label id="cLabel" for="languageFilterImage" style="display: none;">
                Language Filter: 
                    C++
                  
              </label>
              <label id="jsharpLabel" for="languageFilterImage" style="display: none;">
                Language Filter: 
                    J#
                  
              </label>
              <label id="jsLabel" for="languageFilterImage" style="display: none;">
                Language Filter: 
                    JScript
                  
              </label>
            </span>
          </td>
        </tr>
      </table>
      <div id="languageSpan" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
        <input type="checkbox" name="languageFilter" onClick="SetLanguage(this)" id="vbDeclarationCheckbox" />
        <label class="languageFilter" for="vbDeclarationCheckbox">Visual Basic (Declaration)</label>
        <br />
        <input type="checkbox" name="languageFilter" onClick="SetLanguage(this)" id="vbUsageCheckbox" />
        <label class="languageFilter" for="vbUsageCheckbox">Visual Basic (Usage)</label>
        <br />
        <input type="checkbox" name="languageFilter" onClick="SetLanguage(this)" id="csCheckbox" />
        <label class="languageFilter" for="csCheckbox">C#</label>
        <br />
        <input type="checkbox" name="languageFilter" onClick="SetLanguage(this)" id="cCheckbox" />
        <label class="languageFilter" for="cCheckbox">C++</label>
        <br />
        <input type="checkbox" name="languageFilter" onClick="SetLanguage(this)" id="jsharpCheckbox" />
        <label class="languageFilter" for="jsharpCheckbox">J#</label>
        <br />
        <input type="checkbox" name="languageFilter" onClick="SetLanguage(this)" id="jsCheckbox" />
        <label class="languageFilter" for="jsCheckbox">JScript</label>
        <br />
      </div>
    </div>
    <div id="mainSection">
      <div id="mainBody">
        <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()">
        </div>
        <font color="DarkGray"></font><p />
    <p>You can create persistent relationships between database tables based on a simple or complex expression or their indexes. These relationships are stored in the database (.dbc) file. The type of index tag or key determines the type of persistent relationship you can create. For example, in a one-to-many relationship between two tables, you must use a primary or candidate index tag or key in a table for the "one" side in the relationship and a regular index tag or key in the other table for the "many" side in the relationship.</p>
    <p>Before you can create a persistent relationship, you need to perform the following steps:  </p>
    <ol><li>
        <p>Determine which table contains the primary records and which table contains the related records.</p>
      </li><li>
        <p>In the table with the primary records, add an integer field, and then add a primary index on the new field.</p>
      </li><li>
        <p>In the table with the related records, add a field that matches the primary index key in the primary record table, and then add a regular index on that new field. </p>
        <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>
          <p>Use the same expression for both indexes. For example, if you use a function in the expression on the primary key field, you need to use the same function in the expression on the foreign key field.</p>
        </td></tr></table></div>
      </li></ol>
    <p>For more information, see <span class="linkTerms"><a href="/html/546d8e9c-ad2e-43a6-88ac-6c1032532322.htm">Identifying Relationships</a></span> and <span class="linkTerms"><a href="/html/6c693848-3db7-4f60-b52c-11484cb097cc.htm">Working with Table Indexes</a></span>.</p>
  <h3 class="procedureSubHeading">To create a persistent relationship between tables</h3><div class="subSection"><ol><li>
        
          <p>Open the database in the <b>Database Designer</b>.</p>
        
      </li><li>
        
          <p>In the <b>Database Designer</b>, drag the index name from the table you want to relate to the index name in the related table.</p>
        
      </li></ol></div><div id="sectionSection0" class="seeAlsoNoToggleSection">
      <p>A line representing the persistent relationship between the two tables appears in the Database Designer. </p>
      <p>For more information, see <span class="linkTerms"><a href="/html/316676c8-1232-4756-b385-fa7af6528835.htm">Database Designer (Visual FoxPro)</a></span>.</p>
      <h3 class="procedureSubHeading">To create a persistent relationship between tables programmatically</h3><div class="subSection"><ul><li>
            
              <p>Use the <b>CREATE TABLE</b> or <b>ALTER TABLE</b> commands with the <b>FOREIGN KEY</b> clause.</p>
            
          </li></ul></div>
      <p>For more information, see <span class="linkTerms"><a href="/html/b14e5d95-5b1c-4cfa-a5ac-4093ea6211e0.htm">CREATE TABLE - SQL Command</a></span> and <span class="linkTerms"><a href="/html/3c5a454a-67ec-48a8-8290-18dd0e8a97ea.htm">ALTER TABLE - SQL Command</a></span>.</p>
      <p>For example, the following code uses the SQL <b>ALTER TABLE</b> command and the tables Customer and Orders to create a one-to-many persistent relationship, where one customer has many orders, based on the primary index key, <code>Cust_ID</code>, in the Customer table and a new foreign key, <code>cust_id</code>, in the Orders table:</p>
      <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>ALTER TABLE Orders;
   ADD FOREIGN KEY Cust_ID TAG ;
      Cust_Id REFERENCES Customer</pre></td></tr></table></span></div>
    </div><h1 class="heading"><span id="seeAlsoNoToggle">See Also</span></h1><div id="seeAlsoSection" class="seeAlsoNoToggleSection"><h4 class="subHeading">Tasks</h4><span class="linkTerms"><a href="/html/8ff74d7d-30c5-412b-a23a-f3d62261dca3.htm">How to: Open Databases</a></span><br /><span class="linkTerms"><a href="/html/246d4efc-78ff-4db9-87c7-6c4c5237d094.htm">How to: Manage Persistent Relationships Between Tables</a></span><br /><h4 class="subHeading">Reference</h4><span class="linkTerms"><a href="/html/ea7bf414-5b08-4f08-855c-9ba67d09398f.htm">Databases in Visual FoxPro</a></span><br /><h4 class="subHeading">Other Resources</h4><span class="linkTerms"><a href="/html/f69c91ac-86af-4f78-9f04-5b7464635a8c.htm">Creating Databases</a></span><br /><span class="linkTerms"><a href="/html/62869817-db20-4de6-b483-c12e179594e3.htm">Working with Items in Databases</a></span><br /><br /></div></div>
      <div id="footer">
        <div class="footerLine">
          <img width="100%" height="3px" alt="Footer image" src="../local/footer.gif">
            
            
          </img>
        </div>
        <a href="http://go.microsoft.com/fwlink/?LinkId=50040"></a>© Microsoft Corporation. All rights reserved.
      </div>
    </div>
  </body>
</html>