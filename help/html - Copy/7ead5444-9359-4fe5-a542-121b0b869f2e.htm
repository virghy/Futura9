<html DIR="LTR" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">

  <head>

    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" />

    <META NAME="save" CONTENT="history" />

    <title>COMARRAY( ) Function</title>

    

    <link rel="stylesheet" type="text/css" href="../local/Classic.css">

      

    </link>

    

    <script src="../local/EventUtilities.js">

      

    </script>

    <script src="../local/SplitScreen.js">

      

    </script>

    <script src="../local/Dropdown.js">

      

    </script>

    <script src="../local/script.js">

      

    </script>

  </head>

  <body>


    <input type="hidden" id="userDataCache" class="userDataStyle">

    </input>

    <input type="hidden" id="hiddenScrollOffset">

    </input>

    <img id="dropDownImage" style="display:none; height:0; width:0;" alt="Filter choices image" src="../local/drpdown.gif">

      

      

    </img>

    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" alt="DropDownHover image" src="../local/drpdown_orange.gif">

      

      

    </img>

    <img id="collapseImage" style="display:none; height:0; width:0;" alt="Collapse image" src="../local/collapse_all.gif">

      

      

    </img>

    <img id="expandImage" style="display:none; height:0; width:0;" alt="Expand image" src="../local/expand_all.gif">

      

      

    </img>

    <img id="collapseAllImage" style="display:none; height:0; width:0;" alt="CollapseAll image" src="../local/collall.gif">

      

      

    </img>

    <img id="expandAllImage" style="display:none; height:0; width:0;" alt="ExpandAll image" src="../local/expall.gif">

      

      

    </img>

    <img id="copyImage" style="display:none; height:0; width:0;" alt="Copy image" src="../local/copycode.gif">

      

      

    </img>

    <img id="copyHoverImage" style="display:none; height:0; width:0;" alt="CopyHover image" src="../local/copycodeHighlight.gif">

      

      

    </img>

    <div id="header">

      <table width="100%" id="topTable">

        <tr id="headerTableRow1">

          <td align="left">

            <span id="runningHeaderText">

              Visual FoxPro 9.0 SP2

            </span>

          </td>

        </tr>

        <tr id="headerTableRow2">

          <td align="left">

            <span id="nsrTitle">COMARRAY( ) Function</span>

          </td>

        </tr>

        <tr id="headerTableRow3">

          <td>

            <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a> 

									</td>

        </tr>

      </table>

      <table width="100%" id="bottomTable" cellspacing="0" cellpadding="0">

        <tr>

          <td>

            <span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage)" tabindex="0">

              <img ID="toggleAllImage" class="toggleAll" alt="CollapseAll image" src="../local/collall.gif">

                

                

              </img>

              <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">

                Collapse All

              </label>

              <label id="expandAllLabel" for="toggleAllImage" style="display: none;">

                Expand All

              </label> </span>

            <span id="languageFilterToolTip" style="cursor:default;" onmouseover="languageFilterImage.src=dropDownHoverImage.src;" onmouseout="languageFilterImage.src=dropDownImage.src;" tabindex="0">

              <img id="languageFilterImage" alt="Filter choices image" src="../local/drpdown.gif">

                

                

              </img>

              <label id="showAllLabel" for="languageFilterImage" style="display: none;">

                Language Filter: 

                    All

                  

              </label>

              <label id="multipleLabel" for="languageFilterImage" style="display: none;">

                Language Filter: 

                    Multiple

                  

              </label>

              <label id="vbLabel" for="languageFilterImage" style="display: none;">

                Language Filter: 

                    Visual Basic

                  

              </label>

              <label id="csLabel" for="languageFilterImage" style="display: none;">

                Language Filter: 

                    C#

                  

              </label>

              <label id="cLabel" for="languageFilterImage" style="display: none;">

                Language Filter: 

                    C++

                  

              </label>

              <label id="jsharpLabel" for="languageFilterImage" style="display: none;">

                Language Filter: 

                    J#

                  

              </label>

              <label id="jsLabel" for="languageFilterImage" style="display: none;">

                Language Filter: 

                    JScript

                  

              </label>

            </span>

          </td>

        </tr>

      </table>

      <div id="languageSpan" xmlns:msxsl="urn:schemas-microsoft-com:xslt">

        <input type="checkbox" name="languageFilter" onClick="SetLanguage(this)" id="vbDeclarationCheckbox" />

        <label class="languageFilter" for="vbDeclarationCheckbox">Visual Basic (Declaration)</label>

        <br />

        <input type="checkbox" name="languageFilter" onClick="SetLanguage(this)" id="vbUsageCheckbox" />

        <label class="languageFilter" for="vbUsageCheckbox">Visual Basic (Usage)</label>

        <br />

        <input type="checkbox" name="languageFilter" onClick="SetLanguage(this)" id="csCheckbox" />

        <label class="languageFilter" for="csCheckbox">C#</label>

        <br />

        <input type="checkbox" name="languageFilter" onClick="SetLanguage(this)" id="cCheckbox" />

        <label class="languageFilter" for="cCheckbox">C++</label>

        <br />

        <input type="checkbox" name="languageFilter" onClick="SetLanguage(this)" id="jsharpCheckbox" />

        <label class="languageFilter" for="jsharpCheckbox">J#</label>

        <br />

        <input type="checkbox" name="languageFilter" onClick="SetLanguage(this)" id="jsCheckbox" />

        <label class="languageFilter" for="jsCheckbox">JScript</label>

        <br />

      </div>

    </div>

    <div id="mainSection">

      <div id="mainBody">

        <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()">

        </div>

        <font color="DarkGray"></font><p />

    <p>Specifies how to pass arrays to COM objects.</p>

  <div id="syntaxSection" class="section"><div id="syntaxCodeBlocks" class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"></th></tr><tr><td><pre>

COMARRAY(<span class="parameter">oObject</span> [, <span class="parameter">nNewValue</span>])</pre></td></tr></table></span></div></div><p /><h4 class="subHeading">Parameters</h4>

    

      <dl><dt><span class="nonLinkTerms">

          <span class="parameter">oObject</span>

        </span></dt><dd>

          <p>Specifies an object reference to a COM object.</p>

        </dd></dl><dl><dt><span class="nonLinkTerms">

          <span class="parameter">nNewValue</span>

        </span></dt><dd>

          <p>Specifies how to pass an array to a COM object specified with <span class="parameter">oObject</span>. </p>

          <p>The following table lists the settings for <span class="parameter">nNewValue</span> and how the to pass the array to the COM object.   </p>

          <div class="labelheading"><b></b></div><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5"><tr>

                <th>

                  

                    <span class="parameter">nNewValue</span>

                  

                </th>

                <th>

                  Description

                </th>

              </tr><tr>

              <td>

                <p>0</p>

              </td>

              <td>

                <p>The array is a zero-based array and is passed by value.</p>

              </td>

            </tr><tr>

              <td>

                <p>1 </p>

              </td>

              <td>

                <p>The array is a one-based array and is passed by value. Compatible with earlier versions of Visual FoxPro. (Default)</p>

              </td>

            </tr><tr>

              <td>

                <p>10</p>

              </td>

              <td>

                <p>The array is a zero-based array and is passed by reference.</p>

              </td>

            </tr><tr>

              <td>

                <p>11</p>

              </td>

              <td>

                <p>The array is a one-based array and is passed by reference.</p>

              </td>

            </tr><tr>

              <td>

                <p>100</p>

              </td>

              <td>

                <p>The array is a fixed size array and cannot be redimensioned.</p>

              </td>

            </tr><tr>

              <td>

                <p>1000</p>

              </td>

              <td>

                <p>Byte arrays are not converted to strings.</p>

              </td>

            </tr></table></div>

          <p>To return the current setting, call <b>COMARRAY( )</b> without an argument for the <span class="parameter">nNewValue</span> parameter. </p>

        </dd></dl>

    

  <h1 class="heading"><span onclick="ExpandCollapse(returnValueToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(returnValueToggle)" tabindex="0"><img id="returnValueToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Return Value</span></h1><div id="returnValueSection" class="section" name="collapseableSection" style="display: none;">

    

      <p>Numeric. <b>COMARRAY( )</b> returns the current setting.</p>

    

  </div><h1 class="heading"><span onclick="ExpandCollapse(remarksToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(remarksToggle)" tabindex="0"><img id="remarksToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection" style="display: none;">

    

      <p>Use <b>COMARRAY( )</b> only when you pass arrays to COM objects using the following syntax:</p>

      <p>

        <code>oComObject.Method(@MyArray)</code>

      </p>

      <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>

        <p>If you omit the at sign (@), only the first element of the array passes to the COM object, and <b>COMARRAY( )</b> has no effect. This behavior is the same as that in earlier versions of Visual FoxPro.</p>

      </td></tr></table></div>

      <p>When you use a byte array (VT_UI1) to communicate with a COM server, Visual FoxPro converts the byte array into a string. The additive <span class="parameter">nValue</span> of 1000 retains the original proper type of the array and does not convert the result to a string.</p>

      <p>If a client passes a byte array by reference to a Visual FoxPro COM Server, the Visual FoxPro COM Server must also set the <span class="parameter">nValue</span> additive to 1000. You can do this by putting the following call in the Init event of the Visual FoxPro COM Server:</p>

      <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>COMARRAY(THIS,1000)</pre></td></tr></table></span></div>

      <p>The additive <span class="parameter">nValue</span> of 100 makes it possible for you to prevent redimensioning of an array. You should check for possible errors after calling the server in case the server attempts to redimension the array. The following example shows how to prevent redimensioning of the array. To run this example, first build the class definition into a DLL named "t1.dll".</p>

      <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>LOCAL loSvr, laTest

loSvr = NEWOBJECT("t1.arrayhandler")

DIMENSION laTest[10]

laTest=3

? COMARRAY(loSvr,11 + 100)

* The COM server will return an error on the next line of code

* because arrays passed to loSvr will not allow re-dimensioning.

loSvr.RedimensionArray(@laTest,4)

? ALEN(laTest)



DEFINE CLASS ARRAYHANDLER AS CUSTOM OLEPUBLIC

    PROCEDURE RedimensionArray(aArray, nRows)

        DIME aArray[nRows]

    ENDPROC

ENDDEFINE</pre></td></tr></table></span></div>

    

  </div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle)" tabindex="0"><img id="seeAlsoToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style="display: none;"><h4 class="subHeading">Reference</h4><span class="linkTerms"><a href="/html/e9e1aeb4-a834-4971-9fa1-6886f1a7b0d0.htm">Passing Arrays to Automation Servers</a></span><br /><span class="linkTerms"><a href="/html/fe11a2d2-b303-45c4-aa0b-5cead9d4ba58.htm">COMCLASSINFO( ) Function</a></span><br /><span class="linkTerms"><a href="/html/932a73fb-6354-402b-bbb2-08386d41fdae.htm">CREATEOBJECT( ) Function</a></span><br /><span class="linkTerms"><a href="/html/f046afe9-7279-4409-a2b9-aca70936a273.htm">GETOBJECT( ) Function</a></span><br /><h4 class="subHeading">Other Resources</h4><span class="linkTerms"><a href="/html/da6b864f-f7c6-43a3-8218-20d56c7a4764.htm">Functions</a></span><br /><span class="linkTerms"><a href="/html/6dcddc3f-9944-4ad8-be2f-003610af616a.htm">Language Reference (Visual FoxPro)</a></span><br /><br /></div></div>

      <div id="footer">

        <div class="footerLine">

          <img width="100%" height="3px" alt="Footer image" src="../local/footer.gif">

            

            

          </img>

        </div>

        <a href="http://go.microsoft.com/fwlink/?LinkId=50040"></a>© Microsoft Corporation. All rights reserved.

      </div>

    </div>

  </body>

</html>
