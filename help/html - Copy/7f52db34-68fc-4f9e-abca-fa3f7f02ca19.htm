<html DIR="LTR" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">

  <head>

    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" />

    <META NAME="save" CONTENT="history" />

    <title>REPLACE Command (Visual FoxPro)</title>

    

    <link rel="stylesheet" type="text/css" href="../local/Classic.css">

      

    </link>

    

    <script src="../local/EventUtilities.js">

      

    </script>

    <script src="../local/SplitScreen.js">

      

    </script>

    <script src="../local/Dropdown.js">

      

    </script>

    <script src="../local/script.js">

      

    </script>

  </head>

  <body>


    <input type="hidden" id="userDataCache" class="userDataStyle">

    </input>

    <input type="hidden" id="hiddenScrollOffset">

    </input>

    <img id="dropDownImage" style="display:none; height:0; width:0;" alt="Filter choices image" src="../local/drpdown.gif">

      

      

    </img>

    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" alt="DropDownHover image" src="../local/drpdown_orange.gif">

      

      

    </img>

    <img id="collapseImage" style="display:none; height:0; width:0;" alt="Collapse image" src="../local/collapse_all.gif">

      

      

    </img>

    <img id="expandImage" style="display:none; height:0; width:0;" alt="Expand image" src="../local/expand_all.gif">

      

      

    </img>

    <img id="collapseAllImage" style="display:none; height:0; width:0;" alt="CollapseAll image" src="../local/collall.gif">

      

      

    </img>

    <img id="expandAllImage" style="display:none; height:0; width:0;" alt="ExpandAll image" src="../local/expall.gif">

      

      

    </img>

    <img id="copyImage" style="display:none; height:0; width:0;" alt="Copy image" src="../local/copycode.gif">

      

      

    </img>

    <img id="copyHoverImage" style="display:none; height:0; width:0;" alt="CopyHover image" src="../local/copycodeHighlight.gif">

      

      

    </img>

    <div id="header">

      <table width="100%" id="topTable">

        <tr id="headerTableRow1">

          <td align="left">

            <span id="runningHeaderText">

              Visual FoxPro 9.0 SP2

            </span>

          </td>

        </tr>

        <tr id="headerTableRow2">

          <td align="left">

            <span id="nsrTitle">REPLACE Command (Visual FoxPro)</span>

          </td>

        </tr>

        <tr id="headerTableRow3">

          <td>

            <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a> 

									<a href="#codeExampleToggle" onclick="OpenSection(codeExampleToggle)">Example</a></td>

        </tr>

      </table>

      <table width="100%" id="bottomTable" cellspacing="0" cellpadding="0">

        <tr>

          <td>

            <span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage)" tabindex="0">

              <img ID="toggleAllImage" class="toggleAll" alt="CollapseAll image" src="../local/collall.gif">

                

                

              </img>

              <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">

                Collapse All

              </label>

              <label id="expandAllLabel" for="toggleAllImage" style="display: none;">

                Expand All

              </label> </span>

            <span id="languageFilterToolTip" style="cursor:default;" onmouseover="languageFilterImage.src=dropDownHoverImage.src;" onmouseout="languageFilterImage.src=dropDownImage.src;" tabindex="0">

              <img id="languageFilterImage" alt="Filter choices image" src="../local/drpdown.gif">

                

                

              </img>

              <label id="showAllLabel" for="languageFilterImage" style="display: none;">

                Language Filter: 

                    All

                  

              </label>

              <label id="multipleLabel" for="languageFilterImage" style="display: none;">

                Language Filter: 

                    Multiple

                  

              </label>

              <label id="vbLabel" for="languageFilterImage" style="display: none;">

                Language Filter: 

                    Visual Basic

                  

              </label>

              <label id="csLabel" for="languageFilterImage" style="display: none;">

                Language Filter: 

                    C#

                  

              </label>

              <label id="cLabel" for="languageFilterImage" style="display: none;">

                Language Filter: 

                    C++

                  

              </label>

              <label id="jsharpLabel" for="languageFilterImage" style="display: none;">

                Language Filter: 

                    J#

                  

              </label>

              <label id="jsLabel" for="languageFilterImage" style="display: none;">

                Language Filter: 

                    JScript

                  

              </label>

            </span>

          </td>

        </tr>

      </table>

      <div id="languageSpan" xmlns:msxsl="urn:schemas-microsoft-com:xslt">

        <input type="checkbox" name="languageFilter" onClick="SetLanguage(this)" id="vbDeclarationCheckbox" />

        <label class="languageFilter" for="vbDeclarationCheckbox">Visual Basic (Declaration)</label>

        <br />

        <input type="checkbox" name="languageFilter" onClick="SetLanguage(this)" id="vbUsageCheckbox" />

        <label class="languageFilter" for="vbUsageCheckbox">Visual Basic (Usage)</label>

        <br />

        <input type="checkbox" name="languageFilter" onClick="SetLanguage(this)" id="csCheckbox" />

        <label class="languageFilter" for="csCheckbox">C#</label>

        <br />

        <input type="checkbox" name="languageFilter" onClick="SetLanguage(this)" id="cCheckbox" />

        <label class="languageFilter" for="cCheckbox">C++</label>

        <br />

        <input type="checkbox" name="languageFilter" onClick="SetLanguage(this)" id="jsharpCheckbox" />

        <label class="languageFilter" for="jsharpCheckbox">J#</label>

        <br />

        <input type="checkbox" name="languageFilter" onClick="SetLanguage(this)" id="jsCheckbox" />

        <label class="languageFilter" for="jsCheckbox">JScript</label>

        <br />

      </div>

    </div>

    <div id="mainSection">

      <div id="mainBody">

        <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()">

        </div>

        <font color="DarkGray"></font><p />

    <p>Updates table records.</p>

  <div id="syntaxSection" class="section"><div id="syntaxCodeBlocks" class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"></th></tr><tr><td><pre>

REPLACE <span class="parameter">FieldName1</span> WITH <span class="parameter">eExpression1</span> [ADDITIVE]

   [, <span class="parameter">FieldName2</span> WITH <span class="parameter">eExpression2</span> [ADDITIVE]] ... [<span class="parameter">Scope</span>]

   [FOR <span class="parameter">lExpression1</span>] [WHILE <span class="parameter">lExpression2</span>] [IN <span class="parameter">nWorkArea</span> | <span class="parameter">cTableAlias</span>]

   [NOOPTIMIZE]</pre></td></tr></table></span></div></div><p /><h4 class="subHeading">Parameters</h4>

    

      <dl><dt><span class="nonLinkTerms">

          <span class="parameter">FieldName1 </span>WITH <span class="parameter">eExpression1</span>[, <span class="parameter">FieldName2 </span>WITH <span class="parameter">eExpression2</span>... ] </span></dt><dd>

          <p>Specifies that the data in <span class="parameter">FieldName1</span> be replaced with the value of the expression <span class="parameter">eExpression1</span>; that the data in <span class="parameter">FieldName2</span> be replaced with the value of the expression <span class="parameter">eExpression2</span>; and so on.</p>

          <p>When the expression value is longer than the width of a numeric field, REPLACE forces the value to fit by carrying out the following steps:   </p>

          <ul><li>

              <p>First, REPLACE truncates decimal places and rounds the remaining decimal portion of the field.</p>

            </li><li>

              <p>If the value still doesn't fit, REPLACE stores the field contents using scientific notation.</p>

            </li><li>

              <p>If the value still doesn't fit, REPLACE replaces the field contents with asterisks.</p>

            </li></ul>

        </dd></dl><dl><dt><span class="nonLinkTerms">ADDITIVE </span></dt><dd>

          <p>Appends to the end of the memo fields replacements to memo fields. ADDITIVE applies to replacements in memo fields only. If you omit ADDITIVE, the memo field is overwritten with the value of the expression.</p>

        </dd></dl><dl><dt><span class="nonLinkTerms">

          <span class="parameter">Scope</span>

        </span></dt><dd>

          <p>Specifies a range of records to replace. The default scope for REPLACE is the current record (NEXT 1).</p>

          <p>Only the records that fall within the range are replaced. The scope clauses are: ALL, NEXT <span class="parameter">nRecords</span>, RECORD <span class="parameter">nRecordNumber</span>, and REST. For more information on scope clauses, see <span class="linkTerms"><a href="/html/c8d51e13-0119-4fc5-a0df-b6a9ab7997bb.htm">Scope Clauses</a></span>.  </p>

        </dd></dl><dl><dt><span class="nonLinkTerms">FOR <span class="parameter">lExpression1</span></span></dt><dd>

          <p>Specifies that the designated fields be replaced only in records for which <span class="parameter">lExpression1</span> evaluates to true (.T.). Including FOR makes it possible for you to conditionally replace records, filtering out those you don't want replaced.</p>

          <p>Rushmore Query Optimization optimizes REPLACE FOR if <span class="parameter">lExpression1</span> is an optimizable expression. For best performance, use an optimizable expression in the FOR clause.    </p>

          <p>For more information, see <span class="linkTerms"><a href="/html/aeb46b6a-783a-4194-ac8d-c46cfb8e9eee.htm">SET OPTIMIZE Command</a></span> and <span class="linkTerms"><a href="/html/e7c36f99-0993-40a7-be80-0717cbe85b8c.htm">Using Rushmore Query Optimization to Speed Data Access</a></span>. </p>

        </dd></dl><dl><dt><span class="nonLinkTerms">WHILE <span class="parameter">lExpression2</span></span></dt><dd>

          <p>Specifies a condition whereby fields are replaced for as long as the logical expression <span class="parameter">lExpression2</span> evaluates to true (.T.).</p>

        </dd></dl><dl><dt><span class="nonLinkTerms">IN <span class="parameter">nWorkArea</span></span></dt><dd>

          <p>Specifies the work area of the table in which records are updated.</p>

        </dd></dl><dl><dt><span class="nonLinkTerms">IN <span class="parameter">cTableAlias</span></span></dt><dd>

          <p>Specifies the alias of the table in which records are updated.</p>

          <p>If you omit <span class="parameter">nWorkArea</span> and <span class="parameter">cTableAlias</span>, records are updated in the table in the currently selected work area. </p>

        </dd></dl><dl><dt><span class="nonLinkTerms">NOOPTIMIZE </span></dt><dd>

          <p>Prevents Rushmore optimization.</p>

          <p>For more information, see <span class="linkTerms"><a href="/html/aeb46b6a-783a-4194-ac8d-c46cfb8e9eee.htm">SET OPTIMIZE Command</a></span> and <span class="linkTerms"><a href="/html/e7c36f99-0993-40a7-be80-0717cbe85b8c.htm">Using Rushmore Query Optimization to Speed Data Access</a></span>. </p>

        </dd></dl>

    

  <h1 class="heading"><span onclick="ExpandCollapse(remarksToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(remarksToggle)" tabindex="0"><img id="remarksToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection" style="display: none;">

    

      <p>REPLACE replaces data in a field with the value in an expression. Fields in unselected work areas must be prefaced with their alias.</p>

      <div class="alert"><table width="100%" cellspacing="0" cellpadding="0"><tr><th align="left"><img class="note" alt="Note" src="../local/note.gif"></img>Note </th></tr><tr><td>

        <p>If the IN clause is omitted, no replacement occurs if the record pointer is at the end of the file in the current work area and you specify a field in another work area.</p>

      </td></tr></table></div>

    

  </div><h1 class="heading"><span onclick="ExpandCollapse(codeExampleToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(codeExampleToggle)" tabindex="0"><img id="codeExampleToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>Example</span></h1><div id="codeExampleSection" class="section" name="collapseableSection" style="display: none;">

    <description xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5">

      

        <p xmlns="">The following example creates a table with 10 records. REPLACE is used to place random values into a field. MIN( ) and MAX( ) displays the maximum and minimum values in the table.</p>

      

    </description>

    <div class="code"><span codeLanguage="other"><table width="100%" cellspacing="0" cellpadding="0"><tr><th> </th><th><span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" tabindex="0"><img class="copyCodeImage" name="ccImage" align="absmiddle" alt="CopyCode image" src="../local/copycode.gif"></img>Copy Code</span></th></tr><tr><td colspan="2"><pre>CLOSE DATABASES

CREATE TABLE Random (cValue N(3))

FOR nItem = 1 TO 10  &amp;&amp; Append 10 records,

   APPEND BLANK

   REPLACE cValue WITH 1 + 100 * RAND( )  &amp;&amp; Insert random values

ENDFOR



CLEAR

LIST  &amp;&amp; Display the values

gnMaximum = 1  &amp;&amp; Initialize minimum value

gnMinimum = 100  &amp;&amp; Initialize maximum value

SCAN 

   gnMinimum = MIN(gnMinimum, cValue)

   gnMaximum = MAX(gnMaximum, cValue)

ENDSCAN

? 'The minimum value is: ', gnMinimum  &amp;&amp; Display minimum value

? 'The maximum value is: ', gnMaximum  &amp;&amp; Display maximum value</pre></td></tr></table></span></div>

  </div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle)" tabindex="0"><img id="seeAlsoToggle" onload="OnLoadImage()" class="toggle" name="toggleSwitch" alt="Expand image" src="../local/expand_all.gif"></img>See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style="display: none;"><h4 class="subHeading">Reference</h4><span class="linkTerms"><a href="/html/059d1397-f71d-4cd7-9d0e-1d443155bc95.htm">GATHER Command</a></span><br /><span class="linkTerms"><a href="/html/f9d15b20-eb9d-4c37-8d4a-d9d02c01eb56.htm">INSERT - SQL Command</a></span><br /><span class="linkTerms"><a href="/html/e5d1e608-a184-4cfb-8a06-f83ab8a6c50c.htm">SCATTER Command</a></span><br /><h4 class="subHeading">Other Resources</h4><span class="linkTerms"><a href="/html/1b0b5237-6e5d-43cd-b3a6-6ebe7a470a0e.htm">Commands (Visual FoxPro)</a></span><br /><br /></div></div>

      <div id="footer">

        <div class="footerLine">

          <img width="100%" height="3px" alt="Footer image" src="../local/footer.gif">

            

            

          </img>

        </div>

        <a href="http://go.microsoft.com/fwlink/?LinkId=50040"></a>© Microsoft Corporation. All rights reserved.

      </div>

    </div>

  </body>

</html>
